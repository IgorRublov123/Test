--Задание:

/*

Вопрос №9

В базе данных MS SQL Server есть продукты и категории. 
Одному продукту может соответствовать много категорий, 
в одной категории может быть много продуктов. 
Напишите SQL запрос для выбора всех пар «Имя продукта – Имя категории».
Если у продукта нет категорий, то его имя все равно должно выводиться.

*/

-- Создаём таблицу продуктов.
CREATE TABLE dbo.[Product]
(
    [Id] int NOT NULL PRIMARY KEY,
    [Name] VARCHAR(100) NOT NULL
);
GO

--Наполняем таблицу продуктов данными.
INSERT [Product]
([Id], [Name])
VALUES  
(1, 'Мясо'),
(2, 'Дезодорант'),
(3, 'Термоклей'),
(4, 'Гвозди'),
(5, 'Молоко'),
(6, 'Консервы'),
(7, 'Сыр'),
(8, 'Шампунь'),
(9, 'Молоток'),
(10, 'Стул'),
(11, 'Сёмга'),
(12, 'Форель')
GO

--Создаём таблицу категорий продуктов.
CREATE TABLE dbo.[Category]
(
    [Id] int NOT NULL PRIMARY KEY,
    [Name] varchar(100) NOT NULL
);

--Наполняем таблицу категорий продуктов данными.
INSERT [Category]
(Id, [Name])
VALUES
(1, 'Продукты'),
(2, 'Стройматериалы'),
(3, 'Парфюмерия'),
(4, 'Медикаменты'),
(5, 'Мебель'),
(6, 'Рыба')
GO

--Создаём связную таблицу между продуктами и категориями.
CREATE TABLE [PrCat]
 (
	prId INT not null,
	catId INT not null
);
GO

--Устанавливаем взаимосвязи по Id между записями из
--таблицы продуктов и таблицы категорий продуктов.
INSERT INTO [PrCat]
(prId, catId)
VALUES  
(1, 1),
(2, 3),
(3, 2),
(4, 2),
(5, 1),
(6, 1),
(7, 1),
(8, 3),
(9, 2),
(11, 1),
(11, 6),
(12, 1),
(12, 6)

--Формируем запрос
SELECT pr.Name AS [Продукт], cat.Name AS [Категория]
FROM Product pr
LEFT JOIN PrCat prodcat 
	ON pr.id = prodcat.prId
LEFT JOIN Category cat 
	ON cat.id = prodcat.catId 
ORDER BY pr.Name

--Результаты выборки.

/*

     [Продукт]      [Категория]
1.    Гвозди	    Стройматериалы
2.    Дезодорант	Парфюмерия
3.    Консервы	    Продукты
4.    Молоко	    Продукты
5.    Молоток	    Стройматериалы
6.    Мясо	        Продукты
7.    Сёмга	        Продукты
8.    Сёмга	        Рыба
9.    Стул	        NULL
10.   Сыр	        Продукты
11.   Термоклей	    Стройматериалы
12.   Форель	    Продукты
13.   Форель	    Рыба
14.   Шампунь	    Парфюмерия

*/
